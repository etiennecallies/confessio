{% extends 'layouts/base.html' %}
{% load static %}

{% load i18n %}

{% block title %}{{ website.name }} - Revue{% endblock title %}

{% block content %}
    <main>
        <section class="section section-header pt-5 pb-5 bg-primary">
            <div class="container">
                <div class="row text-white justify-content-center">
                    <div class="col-12 col-xl-8 text-center">
                        <h1 class="display-2">Revue de la paroisse {{ website.name }}</h1>
                    </div>
                </div>

                {% if success_message %}
                    <div class="row justify-content-center">
                        <div class="col-12 col-lg-8">
                            <div class="alert alert-success alert-dismissible fade show" role="alert">
                                <span class="alert-inner--icon"><i class="far fa-thumbs-up"></i></span>
                                <span class="alert-inner--text">{{ success_message }}</span>
                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        </div>
                    </div>
                {% endif %}

                <div class="row justify-content-center">
                    <div class="col-12 col-lg-8">
                        <!-- Display Card -->
                        <div class="card border-0 mt-4">
                            <div class="card-body">
                                <h4>1Ô∏è‚É£ √âglises</h4>
                                {% include 'includes/website_churches.html' %}
                                <a class="link-info" href="{% url 'index' %}?websiteUuid={{ website.uuid }}">Voir la carte</a>

                                <h4 class="mt-3">2Ô∏è‚É£ Paragraphes extraits concernant les confessions</h4>
                                <p>Site de la paroisse :
                                    <a href="{{ website.home_url }}" class="link-info" target="_blank">
                                        {{ website.home_url }} <i class="fas fa-up-right-from-square"></i>
                                    </a>
                                </p>
                                {% include 'includes/website_sources.html' %}

                                <h4 class="mt-3">3Ô∏è‚É£ Horaires rep√©r√©s</h4>
                                {% include 'includes/website_schedules.html' %}
                            </div>
                        </div>
                        <!-- End of Display Card -->

                        <!-- Form Card -->
                        <div class="card border-0 mt-4">
                            <div class="card-body">
                                <h4>üí¨ Votre retour</h4>
                                <form id="feedbackForm" method="POST">
                                    {% csrf_token %}
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="feedback_type" value="good" required>
                                            {% trans 'report_feedback_good' %}
                                        </label>
                                    </div>
                                    <div class="radio-group">
                                        <label>
                                            <input type="radio" name="feedback_type" value="outdated">
                                            {% trans 'report_feedback_outdated' %}
                                        </label>
                                    </div>
                                    <div class="radio-group disable-select-until-check">
                                        <label>
                                            <input class='check-necessary' type="radio" name="feedback_type" value="error">
                                            {% trans 'report_feedback_error' %}
                                        </label>
                                        <label>
                                            <select name="error_type">
                                                <option value="">S√©lectionnez le type d'erreur</option>
                                                <option value="churches">1. Dans la liste des √©glises</option>
                                                <option value="paragraphs">2. Dans les paragraphes extraits du site</option>
                                                <option value="schedules">3. Dans les horaires rep√©r√©s</option>
                                            </select>
                                        </label>
                                    </div>
                                    <div class="mt-1">
                                        <label for="comment" style="display: none"></label>
                                        <textarea placeholder="Commentaire facultatif" class="form-control" id="comment" name="comment" rows="4"></textarea>
                                    </div>
                                    <div class="mt-3">
                                        <button type="submit" class="btn rounded btn-secondary">Envoyer !</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <!-- End of Form Card -->

                        {% if previous_reports %}
                            <div>
                                <h4 class="text-white mt-5">Retours pr√©c√©dents</h4>
                            </div>

                            {% for report in previous_reports %}
                                {% if report.comment %}
                                    <div class="card border-0 mt-4">
                                        <div class="card-body">
                                            <strong>
                                                {% if report.feedback_type == 'error' %}
                                                    {% trans 'report_feedback_error' %}
                                                {% elif report.feedback_type == 'good' %}
                                                    {% trans 'report_feedback_good' %}
                                                {% elif report.feedback_type == 'outdated' %}
                                                    {% trans 'report_feedback_outdated' %}
                                                {% endif %}
                                            </strong><small> - le {{ report.created_at|date:"d M Y" }}</small>
                                            <div>{{ report.comment }}</div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            <div class="text-white mt-5 text-center">
                                <h5><em>Aucun retour pour le moment.</em></h5>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>
        <!-- End of section -->
    </main>

{% endblock content %}

{% block javascripts %}
    {{ block.super }}
    <script src="{% static 'js/website_card0.js' %}"></script>
{% endblock javascripts %}