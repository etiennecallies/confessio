{% extends 'layouts/moderation_card.html' %}

{% block card %}
    <h2 class="mb-3">
        Report: {{ moderation.get_category_display }}
    </h2>
    {% if moderation.bug_description %}
        <p>Bug description : {{ moderation.bug_description }}</p>
    {% endif %}
    <div>
        <div class="d-inline-block">
            <form method="post">
            {% csrf_token %}
            <button type="submit" class="btn btn-primary">Validate & next</button>
            </form>
        </div>
        <div class="d-inline-block">
            <a class="btn btn-info" role="button" href="{{ next_url }}">Next</a>
        </div>
    </div>

    <p>
        <a class="btn btn-tertiary" href="{% url 'admin:fetching_oclochermatching_change' oclocher_matching.uuid %}" target="_blank" role="button">
            Open OClocherMatching admin <i class="fas fa-up-right-from-square"></i>
        </a>
    </p>

    LLM error detail: {{ oclocher_matching.llm_error_detail }}<br>
    LLM matrix: <pre>{{ oclocher_matching.llm_matrix }}</pre><br>

    Church description by id : <pre>{{ church_desc_by_id_json }}</pre><br>
    Location description by id : <pre>{{ location_desc_by_id_json }}</pre><br>

    {% if locations_desc_with_schedules %}
        Locations with schedules :
        {% for location_desc in locations_desc_with_schedules%}
            <pre>{{ location_desc }}</pre>
        {% endfor %}
    {% endif %}

    {% if moderation.oclocher_organization %}
        Website: {{ moderation.oclocher_organization.website.name }}<br>
        Link: <a href="{% url 'website_view' moderation.oclocher_organization.website.uuid %}" target="_blank">Go to website</a>
    {% endif %}

    {% if not moderation.marked_as_bug_at %}
        <div>
            <form method="post">
                <label>
                    <input type="text" name="bug_description" maxlength="{{ bug_description_max_length }}">
                </label>
                {% csrf_token %}
            <button type="submit" class="btn btn-danger">Report bug & next</button>
            </form>
        </div>
    {% endif %}
    <div>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="delete_moderation" />
            <button type="submit" class="btn btn-gray-700">
                 <i class="fas fa-xmark"></i>
                Delete moderation</button>
        </form>
    </div>
{% endblock card %}